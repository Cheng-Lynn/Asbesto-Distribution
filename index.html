<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- leaflet css link  -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />
     <!--bootstrap css-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" 
  integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" 
  crossorigin="anonymous"/>
    
  <title>Asbestos Distribution</title>

    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        width: 100%;
        height: 100vh;
        z-index: 100;
      }
    </style>
  </head>
  
  <body>

    <div id="head" class="col-md-12">
        <h3 class="text-center" ><span style="color: maroon;padding: inherit;font-size: 24pt;
        font-weight: 900;text-align: center;">Asbestos Prevalence Across Kenyan Counties </h3>

        <p>

    <div id="map"></div>

    <!-- leaflet js link  -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<!-- jquery link  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <!-- <script src="js/L.Control.Locate.min.js"></script> -->
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <!-- <script src="js/Autolinker.min.js"></script> -->
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-control-geocoder.Geocoder.js"></script>
        <script src="js/leaflet.ajax.min.js"></script>
        <script src="data/Counties2.json"></script>


<script>
  var map = L.map("map").setView([-0.9, 39],6.4);

  var osm = L.tileLayer('https://api.maptiler.com/maps/openstreetmap/{z}/{x}/{y}.jpg?key=iWG4UVE2Fx4REa9qTLto', { 
            attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
        });
        
        osm.addTo(map);

function style_Counties(feature) {
  switch(String(feature.properties['Asbestos'])) {
    case '364':
                    return {
                outline: true,
                outlinecolor: 'null',
                fill: true,
                fillColor: 'rgba(227,26,28,1.0)',
                fillOpacity: 1,
                interactive: true,
              }   
                    Break;
              case '37604':  
            return {
                outline: true,
                outlinecolor: 'null',
                fill: true,
                fillColor: 'Yellow', 
                fillOpacity: 0.5,  
                interactive: true,           
    };
}
  }

  $.getJSON('Counties2.json', function (geojson) {
  var jsonlayer = L.geoJson(Counties2.json, {
    onEachFeature: function (feature, layer) {
      layer.bindPopup(feature.properties.name);
    }
  })
  }).addTo(map);

  var Countieslayer = new L.geoJson.ajax(Counties2, {
            attribution: '',
            interactive: true,
            dataVar: 'Counties2',
            layerName: 'Countieslaye',
            onEachFeature: pop_Counties,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_Counties(feature));
            },
  });    
  


        function forEachFeature(feature, layer) {

          var popupContent = '<table>\
          \
            <tr>\
                <th scope="row">COUNTY</th>\
                <td>' + (feature.properties['COUNTY'] !== null ? autolinker.link(feature.properties['COUNTY'].toLocaleString()) : '') + '</td>\
            </tr>\
            <tr>\
                <th scope="row">Shape_Area</th>\
                <td>' + (feature.properties['Shape_Area'] !== null ? autolinker.link(feature.properties['Shape_Area'].toLocaleString()) : '') + '</td>\
            </tr>\
            <tr>\
                <th scope="row">Asbestos</th>\
                <td>' + (feature.properties['Asbestos'] !== null ? autolinker.link(feature.properties['Asbestos'].toLocaleString()) : '') + '</td>\
            </tr>\
        </table>';
       '<br/><a href="https://endelevu.africa/project/9" target="_blank">View this Project</a>';

    layer.bindPopup(popupContent, {maxHeight: 400});

        }

function pop_Counties(feature, layer) {
    layer.on({
        mouseout: function(e) {
            for (i in e.target._eventParents) {
                e.target._eventParents[i].resetStyle(e.target);
            }
            if (typeof layer.closePopup == 'function') {
                layer.closePopup();
            } else {
                layer.eachLayer(function(feature){
                    feature.closePopup()
                });
            }
        },
        mouseover: highlightFeature,
    });
  
    }
    </script>
  </body>
</html>
